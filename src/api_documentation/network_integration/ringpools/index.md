RingPools
=========

Similar to Promo Numbers, because these are generated by Invoca, the
interface is idempotent. By default, RingPools will capture params based
on your Marketing Data Dictionary.

[Learn more about RingPools
here](https://community.invoca.com/t5/call-attribution/basic-knowledge-ringpools/ta-p/530).

<table>
<colgroup>
<col style="width: 12%" />
<col style="width: 40%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="header">
<th>Property</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>id</td>
<td>integer (read-only)</td>
<td>The internal Invoca id of the RingPool.</td>
</tr>
<tr class="even">
<td>id_from_network</td>
<td>string (required)</td>
<td>Network specific id of the RingPool. Unique within network. Not required when auto-generation is enabled at network level.</td>
</tr>
<tr class="odd">
<td>name</td>
<td>string</td>
<td>Arbitrary string. Names the RingPool.</td>
</tr>
<tr class="even">
<td>object_url</td>
<td>string (read-only)</td>
<td>URL for reaching the RingPool in the UI.</td>
</tr>
<tr class="odd">
<td>lifetime_seconds</td>
<td>integer</td>
<td>The guaranteed minimum time that the number will be allocated for this RingPool.</td>
</tr>
<tr class="even">
<td>max_pool_size</td>
<td>integer</td>
<td>The maximum amount of phone numbers to be allotted at one time.</td>
</tr>
<tr class="odd">
<td>preferred</td>
<td>boolean</td>
<td>true or false. Selects this RingPool if the advertiser has multiple RingPools for the campaign and the web integration code does not specify which pool to use.</td>
</tr>
<tr class="even">
<td>destination_phone_number</td>
<td>A phone number to be associated with the RingPool.</td>
<td>When using Destinations UI or the forward to destination IVR node, this number will be used.</td>
</tr>
<tr class="odd">
<td>fill_immediately</td>
<td>boolean</td>
<td>When true, the ringpool will immediately be filled with phone numbers up to the max_pool_size, if numbers are available. When false, the pool will initially fill at 10% capacity to conserve phone number usage. The ringpool will increase phone numbers based on ringpool autoscaling settings and traffic volume.</td>
</tr>
</tbody>
</table>

Endpoint:

`https://invoca.net/api/@@NETWORK_API_VERSION/<network_id>/advertisers/<advertiser_id_from_network>/advertiser_campaigns/<advertiser_campaign_id_from_network>/ring_pools/<ring_pool_id_from_network>.json`

Local RingPool API
------------------

### Local RingPool Creation

The API provides the ability to create RingPools with additional
information that specifies them as being ‘Local’ RingPools. These Local
RingPools use local numbers that are determined by the parameters passed
in by the user of the API. If a local phone number cannot be found the
pool fills those slots (max\_pool\_size) with toll free numbers instead.
When you POST with the correct parameters the Local RingPool is created
and the allocation of local numbers happens later (approx. 10 minutes).
This capability is JSON-only.

POST
----

`https://invoca.net/api/@@NETWORK_API_VERSION/<network_id>/advertisers/<advertiser_id_from_network>/advertiser_campaigns/<advertiser_campaign_id_from_network>/ring_pools.json`

Content Type: application/json

<table>
<colgroup>
<col style="width: 18%" />
<col style="width: 13%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="header">
<th>Property</th>
<th>Type</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>id</td>
<td>integer (read-only)</td>
<td>The internal Invoca id of the RingPool.</td>
</tr>
<tr class="even">
<td>id_from_network</td>
<td>string (required)</td>
<td>Network specific id of the RingPool. Unique within network. Not required when auto-generation is enabled at network level.</td>
</tr>
<tr class="odd">
<td>name</td>
<td>string</td>
<td>Arbitrary string. Names the RingPool.</td>
</tr>
<tr class="even">
<td>destination_type</td>
<td>string (Required)</td>
<td><p>One of:</p>
<p>Advertiser,</p>
<p>API</p></td>
</tr>
<tr class="odd">
<td>object_url</td>
<td>string (read-only)</td>
<td>URL for reaching the RingPool in the UI.</td>
</tr>
<tr class="even">
<td>lifetime_seconds</td>
<td>integer</td>
<td>The guaranteed minimum time that the number will be allocated for this RingPool</td>
</tr>
<tr class="odd">
<td>max_pool_size</td>
<td>integer</td>
<td>The maximum amount of phone numbers to be allotted at one time</td>
</tr>
<tr class="even">
<td>preferred</td>
<td>boolean</td>
<td>true or false. Selects this RingPool if the advertiser has multiple RingPools for the campaign and the web integration code does not specifiy which pool to use.</td>
</tr>
<tr class="odd">
<td>fill_immediately</td>
<td>boolean</td>
<td>When true, the ringpool will immediately be filled with phone numbers up to the max_pool_size, if numbers are available. When false, the pool will initially fill at 10% capacity to conserve phone number usage. The ringpool will increase phone numbers based on ringpool autoscaling settings and traffic volume.</td>
</tr>
<tr class="even">
<td>local_center</td>
<td>hash</td>
<td><p>Requires one of the following</p>
<p>Latitude &amp; Longitude required together</p>
<p>A filled field determines the center to start looking for local numbers at.</p>
<p><strong>"tn_prefix"</strong>: an npa</p>
<p><strong>"zipcode"</strong>: a valid zipcode</p>
<p><strong>"latitude"</strong>: a valid latitude</p>
<p><strong>"longitude"</strong>: a valid longitude</p></td>
</tr>
<tr class="odd">
<td>local_number_preferences</td>
<td>hash</td>
<td><p>All are optional</p>
<p><strong>"search_radius_miles"</strong>: An integer, greater than or equal to 0. Default is 240. Represents the number of miles from the location to search.</p>
<p><strong>"restrict_to_state"</strong>: A boolean. Default is true. Used to restrict search to be within state boundaries.</p>
<p><strong>"allocation_fallback_strategy"</strong>: "UseTollFree" or "Wait". Default is "UseTollFree". If we are unable to fill the RingPool using the location information provided, we will use this parameter to either fill it with TollFree ("UseTollFree") or continue to wait until more numbers become available.</p></td>
</tr>
<tr class="even">
<td>tn_prefix_whitelist</td>
<td>array of strings</td>
<td>an array of stringified limiters on the boundaries of where to look for local numbers given as npa (ex. ["805", "212"])</td>
</tr>
</tbody>
</table>

Response Code: 200

**Request Body**

    {
     "id_from_network": "395",
     "preferred": "true",
     "name": "India DNP",
     "max_pool_size": "3",
     "local_center": {"latitude": 45, "longitude": 45},
     "tn_prefix_whitelist": ["455"],
     "destination_phone_number": "888-111-2222"
    }

**Response Body**

Same as a GET response, includes all the RingPool properties.

### Error Handling

Forbidden – 403:

POST
----

`https://invoca.net/api/@@NETWORK_API_VERSION/<network_id>/advertisers/<advertiser_id_from_network>/advertiser_campaigns/<advertiser_campaign_id_from_network>/ring_pools.json`

Content Type: application/json

Response Code: 403

**Request Body**

    {
      "id_from_network": "395",
      "preferred": "true",
      "name": "India DNP",
      "max_pool_size": "3",
      "local_center": {"bad_key": ""},
      "tn_prefix_whitelist": ["455"]
    }

**Response Body**

    {
      "errors": {
         "class": "RecordInvalid",
         "invalid_data": "Invalid Key in Local Center."
      }
    }
